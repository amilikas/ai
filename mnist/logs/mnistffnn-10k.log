Using CPU, 10 threads with OpenMP
Training data: [10000,784] 29.9 MB
Validation data: [5000,784] 15.0 MB
Testing data: [10000,784] 29.9 MB
Network: mnistffnn
Input layer, shape:[28,28]
Dense(Logistic) shape:[32], parameters:25120, memory:98.2 KB
Dense(Logistic) shape:[32], parameters:1056, memory:4.2 KB
Softmax shape:[10], parameters:330, memory:1.3 KB

Training...
epoch: 1, time: 0.2 secs (speed 0.0), loss (SoftmaxCE): 23055.9590, validation accuracy: 0.1072
epoch: 2, time: 0.2 secs (speed 0.0), loss (SoftmaxCE): 22683.3555, validation accuracy: 0.1958
epoch: 3, time: 0.2 secs (speed 0.0), loss (SoftmaxCE): 22202.6113, validation accuracy: 0.3098
epoch: 4, time: 0.2 secs (speed 0.0), loss (SoftmaxCE): 21186.9668, validation accuracy: 0.4778
epoch: 5, time: 0.2 secs (speed 48725.5), loss (SoftmaxCE): 19486.4805, validation accuracy: 0.5354
epoch: 6, time: 0.2 secs (speed 48725.5), loss (SoftmaxCE): 17309.4102, validation accuracy: 0.5950
epoch: 7, time: 0.2 secs (speed 48725.5), loss (SoftmaxCE): 14959.1016, validation accuracy: 0.6280
epoch: 8, time: 0.2 secs (speed 48725.5), loss (SoftmaxCE): 12875.5010, validation accuracy: 0.6704
epoch: 9, time: 0.2 secs (speed 48029.6), loss (SoftmaxCE): 11223.7861, validation accuracy: 0.7484
epoch: 10, time: 0.2 secs (speed 48029.6), loss (SoftmaxCE): 9922.9805, validation accuracy: 0.7910
epoch: 11, time: 0.2 secs (speed 48029.6), loss (SoftmaxCE): 8875.2275, validation accuracy: 0.8036
epoch: 12, time: 0.2 secs (speed 48029.6), loss (SoftmaxCE): 8017.1475, validation accuracy: 0.8198
epoch: 13, time: 0.2 secs (speed 48029.6), loss (SoftmaxCE): 7325.6201, validation accuracy: 0.8410
epoch: 14, time: 0.2 secs (speed 47894.7), loss (SoftmaxCE): 6758.3398, validation accuracy: 0.8462
epoch: 15, time: 0.2 secs (speed 47894.7), loss (SoftmaxCE): 6303.9648, validation accuracy: 0.8498
Trained in 3.4 secs.
Training set predicted in 0.0 secs with 0.8326 accuracy.
Test set predicted in 0.0 secs with 0.8202 accuracy.
Accuracy  = 0.8202
Precision = 0.821193
Recall    = 0.817442
F1        = 0.819314
Confusion matrix:
 459    9   91   10   19  400   10    0    4    7
  30  766    8   18   44   18   33   15   24   18
  24    5  903    0    3   14    5   17   56    1
   0    4    1  874    5   18    0   13    3   40
  16   53   10   27  595   12   99   16    5   59
  75    6   13   33    1  852    0    1    0    1
   4   19   22    1   46    0  871   36    3    8
   0   36   14   37    5   17   23  859   20   21
   0   32    3    3    1    0    5    5 1086    0
   0    1    1   18   19    0    4    0    0  937
